# SSL Configuration
ssl_certificate         /etc/letsencrypt/live/vsevolodganin.com/fullchain.pem;
ssl_certificate_key     /etc/letsencrypt/live/vsevolodganin.com/privkey.pem;
ssl_trusted_certificate /etc/letsencrypt/live/vsevolodganin.com/chain.pem;
ssl_dhparam             /etc/letsencrypt/dhparams/dhparam.pem;

# Common proxy headers for all locations
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header X-Forwarded-Host $host;
proxy_set_header X-Forwarded-Port $server_port;

# WebSocket support
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection $http_connection;

# Performance settings
proxy_buffering off;
proxy_request_buffering off;
proxy_http_version 1.1;

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name beszel.vsevolodganin.com;

    location / {
        proxy_pass http://beszel:8090;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name filebrowser.vsevolodganin.com;

    location / {
        proxy_pass http://filebrowser:80;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name music.vsevolodganin.com;

    location / {
        proxy_pass http://navidrome:4533;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name plex.vsevolodganin.com;

    location / {
        proxy_pass http://host.docker.internal:32400;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name torrent.vsevolodganin.com;

    location / {
        proxy_pass http://qbittorrent:8080;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name lidarr.vsevolodganin.com;

    location / {
        proxy_pass http://lidarr:8686;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name olivetin.vsevolodganin.com;

    location / {
        proxy_pass http://olivetin:1337;
    }

    location /websocket {
        proxy_pass http://olivetin:1337/websocket;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name slsk.vsevolodganin.com;

    location / {
        proxy_pass http://slskd:5030;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name pyload.vsevolodganin.com;

    location / {
        proxy_pass http://pyload:8000;
    }
}

server {
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name beets.vsevolodganin.com;

    location /socket.io/ {
        proxy_pass http://beets-flask:5001;
    }

    location / {
        proxy_pass http://beets-flask:5001;
    }
}
